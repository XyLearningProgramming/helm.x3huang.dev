## Chaining vps with k3s

1. create new user and configure ssh
    Aims: 1. add ~/.ssh/authorized_keys2
    2. launch ssh service `sudo systemctl enable --now ssh`
    3. `sudo systemctl start sshd` `sudo ss -tlnp | grep sshd`
    4. allow no login with password
    5. allow no login with root
    6. change port for ssh daemon and ssh.socket

```yaml
# /etc/ssh/sshd_config
# ...
PubkeyAuthentication yes
# ...
PasswordAuthentication no
# ...
UseDNS no
PermitRootLogin no
Port 2222

TCPKeepAlive yes
ClientAliveInterval 30
ClientAliveCountMax 120
```

```yaml
# /etc/systemd/system/ssh.service.requires/ssh.socket
[Unit]
Description=OpenBSD Secure Shell server socket
Before=sockets.target ssh.service
ConditionPathExists=!/etc/ssh/sshd_not_to_be_run

[Socket]
ListenStream=2222
Accept=no
FreeBind=yes

[Install]
WantedBy=sockets.target
RequiredBy=ssh.service
```

2. download k3s and chain slave to master